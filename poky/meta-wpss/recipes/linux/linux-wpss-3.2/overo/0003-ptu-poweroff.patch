--- git/drivers/mfd/twl-core.c.orig	2013-01-17 03:39:28.456702963 +0100
+++ git/drivers/mfd/twl-core.c	2013-01-17 03:37:52.798768034 +0100
@@ -42,6 +42,9 @@
 
 #if defined(CONFIG_ARCH_OMAP2) || defined(CONFIG_ARCH_OMAP3)
 #include <plat/cpu.h>
+#include <../mux.h>
+#include <linux/gpio.h>
+#include <linux/delay.h>
 #endif
 
 /*
@@ -1224,6 +1227,16 @@
 			"PM_MASTER P1_SW_EVENTS\n",
 			DRIVER_NAME, err);
 }
+static void ptu_poweroff(void)
+{
+	int i;
+	omap_mux_set_gpio(OMAP_MUX_MODE4 | OMAP_PIN_OUTPUT, 184);
+	gpio_direction_output(184, 0);
+//	gpio_set_value(184,0);
+	for(i=0;i<60;i++)
+		msleep(1000);
+	twl_poweroff();
+}
 
 /* NOTE:  this driver only handles a single twl4030/tps659x0 chip */
 static int __devinit
@@ -1322,7 +1335,7 @@
 	if(twl_has_poweroff())
 	{
 		/* initialize pm_power_off routine */
-		pm_power_off = twl_poweroff;
+		pm_power_off = ptu_poweroff;
 	}
 
 	status = add_children(pdata, id->driver_data);
